{"version":3,"sources":["webpack:///C:/Users/10203/firstdemo/nwpro3/newpro3/components/image/compress.vue?aa4c","webpack:///C:/Users/10203/firstdemo/nwpro3/newpro3/components/image/compress.vue?06f0","webpack:///C:/Users/10203/firstdemo/nwpro3/newpro3/components/image/compress.vue?4ff8","webpack:///C:/Users/10203/firstdemo/nwpro3/newpro3/components/image/compress.vue?a0c9","webpack:///C:/Users/10203/firstdemo/nwpro3/newpro3/components/image/compress.vue"],"names":["name","props","quality","type","Number","default","maxwh","changes","Function","data","imageW","imageH","redio","methods","yasuo","img","Promise","resolve","reject","uni","getImageInfo","src","success","res","ratio","parseFloat","width","height","parseInt","ctx","createCanvasContext","drawImage","path","draw","e","fileType","replace","canvasToTempFilePath","x","y","destWidth","destHeight","canvasId","res2","oldWidth","oldHeight","yasuoImg","imgs","val","resolves","length","then","push","imgs2","i","$emit"],"mappings":"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","file":"components/image/compress.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./compress.vue?vue&type=template&id=028debdc&\"\nvar renderjs\nimport script from \"./compress.vue?vue&type=script&lang=js&\"\nexport * from \"./compress.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"C:/Users/10203/firstdemo/nwpro3/newpro3/components/image/compress.vue\"\nexport default component.exports","export * from \"-!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./compress.vue?vue&type=template&id=028debdc&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./compress.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\浏览器下载\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./compress.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n\n// 图片批量压缩使用说明  返回值h5=base64 字符串，微信小程序/h5+ 返回=图片地址链接\n// 父页面<compress ref=\"compress\" :maxwh=\"maxwh=720\" :quality=\"quality=0.8\" @changes=\"callback =function(e){}\"> </compress>\n// 两种使用方式 \n// 1监听changes函数获得处理完成返回执\n// 2 使用 this.$refs.compress.yasuoImg(['bold:eqweew.jpg','bold:'fdsfdsf,jpg']).then(e=>{\n//                        console.log(e) //返回值\n//                    })\nexport default {\n    name: 'image-compress',\n    props: {\n        quality: {\n            //质量\n            type: Number,\n            default: 1\n        },\n        maxwh: {\n            //最大宽高尺寸像素\n            type: Number,\n            default: 1920\n        },\n        changes: {\n            //监听变化\n            type: Function,\n            default: null\n        }\n    },\n\n    data() {\n        return {\n            imageW: this.maxwh,\n            imageH: this.maxwh,\n            redio: 1,\n        }\n    },\n    methods: {\n        yasuo(img) {\n            return new Promise((resolve, reject) => {\n                uni.getImageInfo({\n                    src: img,\n                    success: (res) => {\n                        var ratio = parseFloat(res.width / res.height); //获得图片实际的宽高比\n                        var width = res.width;\n                        var height = res.height;\n                        // console.log(this.maxwh)\n                        var maxwh = this.maxwh;\n                        if (width > maxwh || height > maxwh) {\n                            if (width > height) {\n                                width = maxwh;\n                                height = parseInt(width / ratio);\n                            } else {\n                                height = maxwh;\n                                width = parseInt(height * ratio);\n                            }\n                        }\n\n                        this.imageW = width;\n                        this.imageH = height;\n                        // 将图片写入画布\n                        var ctx = uni.createCanvasContext('myCanvas', this);\n                        ctx.drawImage(res.path, 0, 0, width, height);\n                        // console.log(ctx)\n                        ctx.draw(true, (e) => {\n                            // console.log(e)\n                            // 获取画布要裁剪的位置和宽度   均为百分比 * 画布中图片的宽度  \n                            var fileType = res.path.replace(/^.+\\./, '');\n                            if (fileType == 'png') {\n                                fileType = 'png';\n                            } else {\n                                fileType = 'jpg';\n                            }\n                            // console.log(fileType)\n                            uni.canvasToTempFilePath({\n                                x: 0,\n                                y: 0,\n                                width: width,\n                                height: height,\n                                destWidth: width,\n                                destHeight: height,\n                                quality: this.quality,\n                                canvasId: 'myCanvas',\n                                fileType: fileType,\n                                success: (res2) => {\n                                    // console.log(res)\n                                    res2.oldWidth = res.width;\n                                    res2.oldHeight = res.height;\n                                    res2.width = width;\n                                    res2.height = height;\n                                    res2.path = res.path;\n                                    res2.fileType = fileType;\n                                    resolve(res2)\n\n\n                                }\n                            }, this);\n                        });\n\n                    }\n                })\n            })\n        },\n        yasuoImg(imgs, val) {\n\n            var val = val || [];\n            var imgs = imgs;\n            return new Promise((resolve, reject) => {\n                var resolves = resolves || resolve;\n                if (typeof imgs == 'object') {\n\n                    if (imgs.length) {\n                        this.yasuo(imgs[0]).then(e => {\n                            val.push(e)\n                            var imgs2 = [];\n                            for (var i = 0; i < imgs.length; i++) {\n                                if (i != 0) {\n                                    imgs2.push(imgs[i])\n                                }\n                            }\n                            this.yasuoImg(imgs2, val).then(e => {\n                                resolve(e)\n                            })\n\n                        })\n\n                    } else {\n                        resolve(val)\n                        this.$emit(\"changes\", val);\n                    }\n                } else {\n\n                    this.yasuoImg(imgs).then(e => {\n                        resolve(val)\n                        this.$emit(\"changes\", val);\n                    })\n                }\n            })\n        }\n    }\n\n}\n"],"sourceRoot":""}